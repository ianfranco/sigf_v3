<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:p="http://primefaces.org/ui">

    <ui:composition>
        <p:dialog id="TrabajadorCreateDlg" widgetVar="TrabajadorCreateDialog" modal="true" resizable="false" appendTo="@(body)" closeOnEscape="true" header="Registro Nuevo Trabajador">
            <h:form id="TrabajadorCreateForm">
                <h:panelGroup id="display" >
                    <p:fieldset id="personal2" legend="General">
                        <p:panel id="personal" style="margin-top: 20px;width: 750px;">
                            <h:panelGrid columns="4" columnClasses="label, value">
                                <p:outputLabel value="Cód.:" for="codigoTrabajador" />
                                <h:panelGroup>
                                    <p:inputText id="codigoTrabajador" value="#{trabajadorController.selected.codigoTrabajador}" required="true" requiredMessage="Debe ingresar un código"/>                                        
                                </h:panelGroup>

                                <p:outputLabel/>
                                <p:outputLabel/>

                                <p:outputLabel value="Rut:" for="rutTrabajador" />
                                <h:panelGroup>
                                    <p:inputText id="rutTrabajador" value="#{trabajadorController.selected.rutTrabajador}" title="#{bundle.CreateTrabajadorTitle_rutTrabajador}" required="true" requiredMessage="#{bundle.CreateTrabajadorRequiredMessage_rutTrabajador}" maxlength="9"  autocomplete="false">
                                        <p:ajax event="blur" listener="#{trabajadorController.validarRut}" update="rutTrabajador, growl" global="false"/>                                            
                                    </p:inputText>
                                </h:panelGroup>

                                <p:outputLabel value="Nombres" for="nombreTrabajador" />
                                <h:panelGroup>
                                    <p:inputText id="nombreTrabajador" value="#{trabajadorController.selected.nombreTrabajador}" title="#{bundle.CreateTrabajadorTitle_nombreTrabajador}" required="true" requiredMessage="#{bundle.CreateTrabajadorRequiredMessage_nombreTrabajador}" size="30" autocomplete="false"/>                                        
                                </h:panelGroup>

                                <p:outputLabel value="Apellido P." for="apellidoPaternoTrabajador" />
                                <h:panelGroup>
                                    <p:inputText id="apellidoPaternoTrabajador" value="#{trabajadorController.selected.apellidoPaternoTrabajador}" title="#{bundle.CreateTrabajadorTitle_apellidoPaternoTrabajador}" required="true" requiredMessage="#{bundle.CreateTrabajadorRequiredMessage_apellidoPaternoTrabajador}" size="30" autocomplete="false"/>                                        
                                </h:panelGroup>

                                <p:outputLabel value="Apellido M.:" for="apellidoMaternoTrabajador" />
                                <h:panelGroup>
                                    <p:inputText id="apellidoMaternoTrabajador" value="#{trabajadorController.selected.apellidoMaternoTrabajador}" title="#{bundle.CreateTrabajadorTitle_apellidoMaternoTrabajador}" required="true" requiredMessage="#{bundle.CreateTrabajadorRequiredMessage_apellidoMaternoTrabajador}" size="30" autocomplete="false"/>
                                </h:panelGroup>

                                <p:outputLabel value="F.Nacimiento:" for="fechaNacimientoTrabajador" />
                                <h:panelGroup>
                                    <p:calendar id="fechaNacimientoTrabajador" pattern="dd/MM/yyyy" value="#{trabajadorController.selected.fechaNacimientoTrabajador}" title="#{bundle.CreateTrabajadorTitle_fechaNacimientoTrabajador}"  showOn="button" autocomplete="false"/>
                                </h:panelGroup>
                                <p:outputLabel value="País:" for="nacionalidad" />
                                <h:panelGroup>     
                                    <p:selectOneRadio id="nacionalidad" value="#{trabajadorController.nacionalidad}" required="true">
                                        <f:selectItem itemLabel="Chile" itemValue="1" />
                                        <f:selectItem itemLabel="Extranjero" itemValue="0" />
                                    </p:selectOneRadio>
                                </h:panelGroup>

                                <p:outputLabel/>
                                <p:outputLabel/>

                                <p:outputLabel/>
                                <p:outputLabel/>

                                <p:outputLabel value="Dirección:" for="calleTrabajador" />
                                <h:panelGroup>
                                    <p:inputText id="calleTrabajador" value="#{trabajadorController.selected.calleTrabajador}" size="35" autocomplete="false"/>
                                </h:panelGroup>

                                <p:outputLabel value="N°/Depto:" for="numeroDireccionTrabajador" />
                                <h:panelGroup>
                                    <p:inputText id="numeroDireccionTrabajador" value="#{trabajadorController.selected.numeroDireccionTrabajador}" size="15" autocomplete="false"/>
                                </h:panelGroup>

                                <p:outputLabel value="Comuna:" for="comuna" />
                                <h:panelGroup>
                                    <p:selectOneMenu id="comuna" value="#{trabajadorController.selected.comuna}" required="true" requiredMessage="#{bundle.CreateTrabajadorRequiredMessage_comuna}" converter="comunaConverter">
                                        <f:selectItem itemLabel="#{bundle.SelectOneMessage}"/>
                                        <f:selectItems value="#{comunaController.items}"
                                                       var="comunaItem"
                                                       itemValue="#{comunaItem}"
                                                       itemLabel="#{comunaItem}"
                                                       />

                                    </p:selectOneMenu>
                                </h:panelGroup>
                                <p:outputLabel value="Sexo:" for="sexo" />
                                <h:panelGroup>
                                    <p:selectOneRadio id="sexo" value="#{trabajadorController.sexo}" required="true">
                                        <f:selectItem itemLabel="Hombre" itemValue="1" />
                                        <f:selectItem itemLabel="Mujer" itemValue="0" />
                                    </p:selectOneRadio>
                                </h:panelGroup>

                                <p:outputLabel value="Estado Civil:" for="estadoCivil" />
                                <h:panelGroup>
                                    <p:selectOneRadio id="estadoCivil" value="#{trabajadorController.estadoCivil}" required="true">
                                        <f:selectItem itemLabel="Soltero" itemValue="0" />
                                        <f:selectItem itemLabel="Casado" itemValue="1" />
                                        <f:selectItem itemLabel="Separado" itemValue="2" />
                                        <f:selectItem itemLabel="Viudo" itemValue="3" />
                                        <p:ajax event="valueChange" update="growl" listener="#{trabajadorController.addMessageContrato}"/>
                                    </p:selectOneRadio>
                                </h:panelGroup>

                                <p:outputLabel value="Teléfono:" for="telefonoFijoTrabajador" />
                                <h:panelGroup>
                                    <p:inputText id="telefonoFijoTrabajador" value="#{trabajadorController.selected.telefonoFijoTrabajador}" title="#{bundle.CreateTrabajadorTitle_telefonoFijoTrabajador}" autocomplete="false"/>
                                </h:panelGroup>

                                <p:outputLabel value="Celular:" for="celularTrabajador" />
                                <h:panelGroup>
                                    <p:inputText id="celularTrabajador" value="#{trabajadorController.selected.celularTrabajador}" title="#{bundle.CreateTrabajadorTitle_celularTrabajador}" autocomplete="false"/>
                                </h:panelGroup>

                                <p:outputLabel value="Email:" for="emailTrabajador" />
                                <h:panelGroup>
                                    <p:inputText id="emailTrabajador" value="#{trabajadorController.selected.emailTrabajador}" title="#{bundle.CreateTrabajadorTitle_emailTrabajador}" autocomplete="false"/>
                                </h:panelGroup>

                                <p:outputLabel value="G.A.F.:" for="gaf"/>
                                <h:panelGroup>
                                    <p:selectOneMenu id="gaf" value="#{trabajadorController.selected.asignacionFamiliar}" required="true" requiredMessage="#{bundle.CreateTrabajadorRequiredMessage_comuna}" converter="asignacionFamiliarConverter">
                                        <f:selectItem itemLabel="#{bundle.SelectOneMessage}"/>
                                        <f:selectItems value="#{trabajadorController.asignacionFamiliarItems}"
                                                       var="gafItem"
                                                       itemValue="#{gafItem}"
                                                       itemLabel="#{gafItem}"
                                                       />
                                    </p:selectOneMenu>
                                </h:panelGroup>

                                <p:outputLabel value="N° Cargas:" for="cargasTrabajador" />
                                <h:panelGroup>
                                    <p:inputText id="cargasTrabajador" value="#{trabajadorController.selected.numeroCargas}" title="#{bundle.CreateTrabajadorTitle_emailTrabajador}" autocomplete="false"/>
                                </h:panelGroup>


                            </h:panelGrid>
                        </p:panel>
                        </p:fieldset>

                        <p:fieldset id="address" legend="Previsión">
                            <p:panel id="previsional" style="margin-top: 20px;width: 750px;">

                                <h:panelGrid columns="2" columnClasses="label, value">

                                    <p:outputLabel value="Tipo Cotización:" for="tipoCotizacionTrabajador" />
                                    <h:panelGroup>
                                        <p:selectOneMenu id="tipoCotizacionTrabajador" value="#{trabajadorController.selected.tipoCotizacionTrabajador}" required="true" requiredMessage="#{bundle.CreateTrabajadorRequiredMessage_tipoCotizacionTrabajador}" converter="tipoCotizacionTrabajadorConverter" >
                                            <f:selectItem itemLabel="#{bundle.SelectOneMessage}"/>
                                            <f:selectItems value="#{tipoCotizacionTrabajadorController.items}"
                                                           var="tipoCotizacionTrabajadorItem"
                                                           itemValue="#{tipoCotizacionTrabajadorItem}"
                                                           itemLabel="#{tipoCotizacionTrabajadorItem}"
                                                           />
                                            <p:ajax event="valueChange" listener="#{trabajadorController.updateInstitucionPrevision}" update="institucionPrevision" global="false"/>
                                        </p:selectOneMenu>
                                    </h:panelGroup>

                                    <p:outputLabel value="AFP:" for="institucionPrevision" />
                                    <h:panelGroup>
                                        <p:selectOneMenu id="institucionPrevision" value="#{trabajadorController.selected.institucionPrevision}" required="true" requiredMessage="#{bundle.CreateTrabajadorRequiredMessage_institucionPrevision}" converter="institucionPrevisionConverter" disabled="#{trabajadorController.regimen}">
                                            <f:selectItem itemLabel="#{bundle.SelectOneMessage}"/>
                                            <f:selectItems value="#{institucionPrevisionController.items}"
                                                           var="institucionPrevisionItem"
                                                           itemValue="#{institucionPrevisionItem}"
                                                           itemLabel="#{institucionPrevisionItem}"
                                                           />

                                        </p:selectOneMenu>
                                    </h:panelGroup>

                                    <p:outputLabel value="Ahorro Voluntario" for="ips" />                                        
                                    <p:selectBooleanCheckbox id="ips" >
                                        <p:ajax update="institucionApv,montoAPV" event="valueChange" listener="#{trabajadorController.updateAhorro}" global="false"/>
                                    </p:selectBooleanCheckbox>

                                    <p:outputLabel value="APV:" for="institucionApv" />
                                    <h:panelGroup>
                                        <p:selectOneMenu id="institucionApv" value="#{trabajadorController.selected.institucionApv}" required="true" requiredMessage="#{bundle.CreateTrabajadorRequiredMessage_institucionApv}" converter="institucionApvConverter" disabled="#{trabajadorController.ahorro}">
                                            <f:selectItem itemLabel="#{bundle.SelectOneMessage}"/>
                                            <f:selectItems value="#{institucionApvController.items}"
                                                           var="institucionApvItem"
                                                           itemValue="#{institucionApvItem}"
                                                           itemLabel="#{institucionApvItem}"
                                                           />

                                        </p:selectOneMenu>
                                    </h:panelGroup>

                                    <p:outputLabel value="Monto APV:" for="montoAPV" />
                                    <h:panelGroup>
                                        <p:inputText id="montoAPV" value="#{trabajadorController.selected.montoApv}" disabled="#{trabajadorController.ahorro}"/>
                                    </h:panelGroup>
                                </h:panelGrid>
                            </p:panel>
                        </p:fieldset>

                        <p:fieldset id="contact" legend="Salud">
                            <p:panel id="salud" style="margin-top: 20px;width: 750px;">
                                <h:panelGrid columns="2" columnClasses="label, value" >

                                    <p:outputLabel value="Fonasa:" for="fonasa" />                                        
                                    <p:selectBooleanCheckbox id="fonasa" value="#{trabajadorController.fonasa}">
                                        <p:ajax update="institucionSalud, monedaPactadaInstitucionSalud, montoSalud" global="false"/>
                                    </p:selectBooleanCheckbox>

                                    <p:outputLabel value="Salud:" for="institucionSalud" />
                                    <h:panelGroup>
                                        <p:selectOneMenu id="institucionSalud" value="#{trabajadorController.selected.institucionSalud}" required="true" requiredMessage="#{bundle.CreateTrabajadorRequiredMessage_institucionSalud}" converter="institucionSaludConverter" disabled="#{trabajadorController.fonasa}">
                                            <f:selectItem itemLabel="#{bundle.SelectOneMessage}"/>
                                            <f:selectItems value="#{institucionSaludController.items}"
                                                           var="institucionSaludItem"
                                                           itemValue="#{institucionSaludItem}"
                                                           itemLabel="#{institucionSaludItem}"
                                                           />
                                        </p:selectOneMenu>
                                    </h:panelGroup>

                                    <p:outputLabel value="Moneda:" for="monedaPactadaInstitucionSalud" />
                                    <h:panelGroup>
                                        <p:selectOneMenu id="monedaPactadaInstitucionSalud" value="#{trabajadorController.selected.monedaPactadaInstitucionSalud}" required="true" requiredMessage="#{bundle.CreateTrabajadorRequiredMessage_monedaPactadaInstitucionSalud}" converter="monedaPactadaInstitucionSaludConverter" disabled="#{trabajadorController.fonasa}">
                                            <f:selectItem itemLabel="#{bundle.SelectOneMessage}"/>
                                            <f:selectItems value="#{monedaPactadaInstitucionSaludController.items}"
                                                           var="monedaPactadaInstitucionSaludItem"
                                                           itemValue="#{monedaPactadaInstitucionSaludItem}"
                                                           itemLabel="#{monedaPactadaInstitucionSaludItem}"
                                                           />
                                        </p:selectOneMenu>
                                    </h:panelGroup>

                                    <p:outputLabel value="Monto:" for="montoSalud" />
                                    <h:panelGroup>
                                        <p:inputText id="montoSalud" value="#{trabajadorController.selected.montoSalud}" title="#{bundle.CreateTrabajadorTitle_montoSalud}" disabled="#{trabajadorController.fonasa}"/>
                                    </h:panelGroup>
                                </h:panelGrid>
                            </p:panel>
                        </p:fieldset>

                        <p:separator/>
                        <p:commandButton actionListener="#{trabajadorController.saveNew}" value="#{bundle.Save}" update="display,:growl, :TrabajadorListForm:datalist" oncomplete="PF('TrabajadorCreateDialog').hide()" process="@this">
                            <p:confirm header="#{bundle.ConfirmationHeader}" message="#{bundle.ConfirmCreateMessage}" icon="ui-icon-alert"/>
                        </p:commandButton>

                        <p:commandButton value="#{bundle.Cancel}" oncomplete="PF('TrabajadorCreateDialog').hide()" update="display" process="@this" immediate="true" resetValues="true"/>
                        <div style="clear:both" />

                </h:panelGroup>
            </h:form>
        </p:dialog>
    </ui:composition>

</html>
